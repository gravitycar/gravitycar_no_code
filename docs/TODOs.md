# To-Do's:

- [X] Figure out if the RelationshipBase class can just use the same metadata property that ModelBase uses, and not relationshipMetadata.
- [X] Change the relationship classes to use the DatabaseConnector to generate their queries.
    - [X] RelationshipBase->add() refactored to use DatabaseConnector->create()
    - [X] RelationshipBase->hasActiveRelation() refactored to use DatabaseConnector->recordExists()
    - [X] RelationshipBase->getActiveRelatedCount() refactored to use DatabaseConnector->getCount()
    - [X] RelationshipBase->getActiveRelationshipRecords() refactored to use DatabaseConnector->find()
    - [X] RelationshipBase->getDeletedRelationshipRecords() refactored to use DatabaseConnector->find()
    - [X] getRelatedRecords() methods consolidated into RelationshipBase using DatabaseConnector->find()
    - [X] Added DatabaseConnector->bulkSoftDeleteByFieldValue() and bulkSoftDeleteByCriteria() methods
    - [X] Removed all hardDeleteAllRelationships() and removeAllRelations() methods (replaced with soft delete)
    - [X] Updated CASCADE_CASCADE operations to use soft delete instead of hard delete
    - [X] Refactored RelationshipBase->bulkSoftDeleteRelationships() to use DatabaseConnector
    - [X] Refactored RelationshipBase->softDeleteRelationship() to use DatabaseConnector
    - [X] Refactored RelationshipBase->softDeleteExistingRelationships() to use DatabaseConnector->bulkSoftDeleteByFieldValue()
    - [X] Refactored OneToOne/OneToMany/ManyToMany->updateRelation() methods to use DatabaseConnector->update()
    - [X] Refactored ManyToManyRelationship->getRelatedWithData() to use DatabaseConnector->find()
    - [X] Moved ManyToManyRelationship->getRelatedPaginated() to RelationshipBase (available to all relationship types)
    - [X] Renamed ModelBase->getRelatedPaginated() to getRelatedWithPagination() to resolve method signature conflict
    - [X] Added DatabaseConnector->bulkUpdateByCriteriaWithFieldValues() as generic bulk update method
    - [X] Refactored bulkSoftDeleteByCriteria() and bulkSoftDeleteByFieldValue() to use generic method
    - [X] Added DatabaseConnector->bulkRestoreByCriteria() for restoring soft-deleted records
    - [X] Refactored RelationshipBase->restoreRelationship() to use DatabaseConnector->bulkRestoreByCriteria()
    - [X] Eliminated createTempModelForTable() method by refactoring DatabaseConnector methods to accept ModelBase objects directly
    - [X] Removed ManyToManyRelationship->batchAdd() methods (feature not supported)
    - [X] ALL raw SQL instances eliminated from relationship classes - 100% DatabaseConnector usage achieved
- [X] Specify the ModelFactory.
- [X] Build ModelFactory.
- [X] Replace every instance in the code where we try to derive a fully qualified class name with a call to the ModelFactory.
- [] Fix ModelBase::getRelationship() to throw an exception if it can't find the named relationship, so it never returns null.
- [] Centralize retrieving the currently logged in user with the Gravitycar class.
- [X] Centralize where we create GUID's. I thought this was in ModelBase but I don't see it.
- [X] Implement metadata loading logic in the MetadataEngine to allow Models and Relationships to retrieve their metadata from the MetaData engine instead of loading their own files.
- [X] Switch Models and Relationships over to using the MetaDataEngine to retrieve their metadata from the MetaDataEngine's cache.
   - [X] Change the lazy loading pattern - it only loads the metadata when a field is accessed, that's not reliable enough.
- [X] Specify the APIBase class, a class parent class for all API controller classes to come. 
- [] Build the Home, MovieQuotesTrivaGame, MovieQuotesTriviaGameQuestions models.
- [] Get rid of the deleted, deleted_at and deleted_by properties in ModelBase. They are cruft.
- [X] Find out what is still passing metadata to RelationshipBase classes and make it stop.
- [X] Implement a route scoring system so we can have flexible route handling.
- [X] Implement a data transfer object to move data about the request into an API controller.
- [X] Implement the ModelBaseApiController class so that it covers all the basic CRUD and Relationship operations.
- [X] Integrate the Apache Web Server with the Gravitycar Framework with an entry point for REST requests.
- [X] Implement a filterCriteria class for processing search criteria from the request.
- [] Implement bulk requests.
- [] Routes seem to be duplicated when they are registered. We need a smarter way to stop that from happening.
- [X] find every instance of $logger or anything else the ServiceLocator handles and replace it with "$this->logger = ServiceLocator::getLogger();"
- [] HelpAPIController - a class that returns a description of all of the supported end points, with the parameter names. 
- [X] MetadataAPIController - a class that returns all or some of our metadata for models and relationships.
- [] Create additional GCExcpetion subclasses
    - [X] Subclasses for every 400-500 HTTP error code.
    - [] Sublcasses for database failures.
    - [] Replace instances of GCException with more specific errors.
    - [] Domain-specific exception classes (e.g., InsufficientInventoryException, AccountSuspendedException) for business logic errors.
- [] Adding new models needs to automatically populate the permissions table with reasonable access defaults.
- [] AuthorizationService->hasPermission() can this be refactored to make only one sql query instead of several, and to return only 0 or 1 rows (only one row should match a user's role and the required permission)
- [] Why is the authentication service generating SQL? That shouldn't be necessary.
- [] Is the database service the same as the database_connector service?
- [] Change the wildcards in API Routes from ? to {paramName}, like ['{modelName}', '{id}', '', '{relatinshipName}']. Then we can get rid of the parameterNames and just parse the param names out of the wildcards.
- [X] The /metadata/modules/<model_name> endpoint should fail, but the APIPathScorer doesn't see it that way. It did pick a very close match, which is good, I guess. But the 'modules' part should have produced a 404 error.
- [] Boolean fields are represented in the database as varchar(255) fields. That's not right. 
- [X] Update the APIRouteScorer class to disqualify any routes where any component doesn't have an exact match or a wildcard match.
- [] Test password reset.
- [] Confirm field validation failures actually result in an exception being thrown before the DBConnector tries to save the record.
- [X] There is no list of timezones for users and it's a required field. 
- [] Dropping fields from metadata no longer drops them from the database? I thought we had that fixed a long time ago.
- [] Model api classes are not being picked up by the APIRegistry.
- [] The FieldFactory constructor calls discoverFieldTypes which scans the Fields directory. That's bad, need to use MetadataEngine.
- [] The FieldFactory needs to take a Model so it can know what table the field belongs to. We need a setModel() method or something.
- [] GoogleAuthTokens::cleanupExpiredTokens() should be using a DatabaseConnector method instead of building its own SQL.
- [] ContainerConfig hard-codes model names to register them. BAD! Make it ues the MetadataEngine.